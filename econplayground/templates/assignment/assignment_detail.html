{% extends 'base.html' %}
{% load bootstrap4 %}

{% block title %}{{ object.title }}{% endblock %}

{% block breadcrumb %}
<nav aria-label="breadcrumb">
    <ol class="breadcrumb">
        <li class="breadcrumb-item">
            <a href="{% url 'assignment_assignment_list' %}" title="Assignment List">
                {% include 'main/your_assignments_snippet.html' %}
            </a>
        </li>
        <li class="breadcrumb-item">
            {{ object.title|truncatewords:5 }}
        </li>
    </ol>
</nav>
{% endblock %}

{% block pagetitle %}
<h1 class="mt-4">{{ object.title }}</h1>
{% endblock %}

{% block pagedescription %}

{% endblock %}

{% block content %}
<div class="container">
    <a class="btn btn-sm btn-secondary float-right"
       href="{% url 'assignment_assignment_edit' object.pk %}"
       title="Edit {{ object.title }}">
        Edit assignment
    </a>

    <div class="assignment-grid d-flex">
        <form name="add_step" method="post"
              class="mr-2"
              action="{% url 'tree_edit' object.pk %}">
            {% csrf_token %}
            <input name="action" value="add_step" type="hidden" />
            <button type="submit" class="btn btn-sm btn-primary">
                <i class="bi bi-plus"></i>
                Add step
            </button>
        </form>

        {% for step in tree %}
            <div class="assignment-step">
                id: {{step.id}}
                <form name="remove_step" method="post"
                      class="float-right mb-1"
                      action="{% url 'tree_edit' object.pk %}">
                    {% csrf_token %}
                    <input name="action" value="remove_step" type="hidden" />
                    <input name="step_id" value="{{step.id}}" type="hidden" />
                    <button type="submit"
                            class="btn btn-sm btn-danger"
                            title="Remove step">
                        <i class="bi bi-x"></i>
                    </button>
                </form>

                <select class="form-control form-control-sm">
                    <option>Select question bank</option>
                </select>

                {% for substep in step.children %}
                    {% if step.id is not substep.id %}
                        <div class="assignment-subpath">
                            <div class="assignment-empty-step">
                                id: {{substep.id}}
                                <form name="remove_step" method="post"
                                      class="text-right mb-1"
                                      action="{% url 'tree_edit' object.pk %}">
                                    {% csrf_token %}
                                    <input type="hidden"
                                           name="action"
                                           value="remove_step" />
                                    <input type="hidden"
                                           name="step_id"
                                           value="{{substep.id}}" />
                                    <button type="submit"
                                            class="btn btn-sm btn-danger"
                                            title="Remove step">
                                        <i class="bi bi-x"></i>
                                    </button>
                                </form>
                            </div>
                        </div>
                    {% endif %}
                {% endfor %}

                <div class="assignment-empty-step">
                    <form name="add_substep" method="post"
                          action="{% url 'tree_edit' object.pk %}">
                        {% csrf_token %}
                        <input type="hidden"
                               name="action"
                               value="add_substep" />
                        <input type="hidden"
                               name="step_id"
                               value="{{step.id}}" />
                        <button class="btn btn-sm btn-primary">
                            <i class="bi bi-plus"></i>
                            Add step
                        </button>
                    </form>
                </div>

            </div>
        {% endfor %}
    </div>

    <hr />

    <p>{{ object.prompt }}</p>
</div>
{% endblock %}
